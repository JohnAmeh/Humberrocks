Second attempt. Here is the code!